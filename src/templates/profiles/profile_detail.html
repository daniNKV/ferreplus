{% extends 'base.html' %}

{% load static %}


{% block head_title %}
  Perfil de {{ profile.user.first_name }} {{ profile.user.last_name }}
{% endblock %}

{% block extra_head %}
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.10.2/dist/full.min.css" rel="stylesheet" type="text/css" />
{% endblock extra_head %}

{% block body %}

{% if messages %}
    <ul id="messages" class="messages">
      {% for message in messages %}
        <div class="toast">
          <div class="alert alert-success">
            <span>{{ message }}</span>
          </div>
        </div>
      {% endfor %}
  </ul>
{% endif %}

{% include 'navbar.html' %}

<section id="hero" class="hero min-h-screen text-dark bg-cover" style="background-image: url({% static 'img/background.png' %})">
  <div class="hero-content w-6/12 bg-neutral flex-col lg:gap-2">
    <h2 class="text-7xl text-center font-bold">{{ profile.user.first_name }} {{ profile.user.last_name }}</h1>

    {% if user.profile.avatar %}
        <img alt="Avatar de {{ profile.user.first_name }}" class="avatar max-w-72 w-h-72 rounded-lg shadow-2xl" src="{{ user.profile.avatar.url }}" />
    {% else %}
        <img alt="Default avatar" class="avatar max-w-72 w-h-72 rounded-lg shadow-2xl" src="{% static 'img/avatar-default.jpg' %}"/>
    {% endif %}
    <div class="join join-horizontal pt-2">
      <a href="#items" class="btn btn-lg btn-outline join-item text-dark">Ver articulos</a>
      {% if user.is_authenticated and user.pk == profile.user.pk %}
        <a href="{% url 'item_create' %}" class="btn btn-lg btn-outline join-item text-dark">Publicar Artículo</a>
        <a href="{% url 'profile_edit' user_id=profile.user.pk %}" class="btn btn-lg btn-outline join-item text-dark">Modificar perfil</a>
      {% endif %}
    </div>
  </div>
</section>

<div class="divider divider-neutral text-3xl p-10 bg-neutral text-dark">Productos ofrecidos por {{ profile.user.first_name }} {{ profile.user.last_name }}</div>

<section id="items" class="hero min-h-screen bg-neutral">
  <div class="hero-content">
    {% if items %}
      <ul class="flex max-w-11/12 flex-wrap pt-20 gap-10">
        {% for item in items %}
          <div class="card w-11/12 max-w-96 relative">
            <figure class="rounded-none z-10">
              <img src="{{ item.image.url }}" class="w-full max-h-72" alt="Martillo" />
            </figure>
            <div class="card-body items-center gap-5 text-center bg-main text-neutral">
              <div class="badge badge-secondary">{{ item.category.name }}</div>
              <h2 class="card-title">
                {{ item.name }}
              </h2>
              <p>{{ item.description|truncatechars:100 }}</p>
              <div class="join join-horizontal ">
                {% if user.is_authenticated and user.pk == profile.user.pk %}
                  <a href="" class="btn join-item btn-outline text-neutral"><i class="fas fa-edit text-2xl text-center"></i>Editar</a>
                  <a href="" class="btn join-item btn-outline text-error "><i class="fa-solid fa-trash text-2xl text-error text-center"></i></i>Eliminar</a>

                {% endif %}
                <!-- <a href="" class="btn w-full btn-outline text-neutral">Ver más</a> -->
              </div>
            </div>
          </div>
        {% empty %}
          <h2 class="text-3xl">Ooops. No hay nada todavía!</li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>
</section>
{% endblock %}


{% block extra_body %}
<script>
  window.setTimeout(function() {
    document.querySelector('.alert').remove()
}, 4000);

</script>
{% endblock extra_body %}